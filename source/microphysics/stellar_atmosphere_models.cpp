/**
 *  \file     stellar_atmosphere_models.cpp
 *  \author   Arun Mathew
 *  \date     05-07-2023
 **/

#include "stellar_atmosphere_models.h"

#define SAM_DEBUG

stellar_atmosphere_models::stellar_atmosphere_models() {}
stellar_atmosphere_models::~stellar_atmosphere_models() {}

// SETTING UP STELLAR ATMOSPHERE MODELS ###################################
void stellar_atmosphere_models::setup_stellar_atmosphere_models(
    std::vector<std::vector<double> > &Ebins,  // Energy bins
    int &N_ebins,                              // Number of energy bins
    double &Emax  // Maximum photo-ionisation energy
)
{

  spdlog::info("Setting up stellar atmosphere module");

  // Define Energy bins here.
  energy_bins = {
      {7.640000e+00, 1.120000e+01}, {1.120000e+01, 1.360000e+01},
      {1.360000e+01, 1.630000e+01}, {1.630000e+01, 2.156000e+01},
      {2.156000e+01, 2.460000e+01}, {2.460000e+01, 3.065000e+01},
      {3.065000e+01, 3.510000e+01}, {3.510000e+01, 4.096000e+01},
      {4.096000e+01, 4.789000e+01}, {4.789000e+01, 5.440000e+01},
      {5.440000e+01, 6.450000e+01}, {6.450000e+01, 7.700000e+01},
  };

  // Get number of energy bins
  N_energy_bins = energy_bins.size();

  // passing energy bin info
  Ebins   = energy_bins;
  N_ebins = N_energy_bins;

  // Get photoionisation maximum energy
  const std::vector<double> &last_bin = energy_bins.back();
  Emax                                = last_bin.back();

  // Initializing stellar atmosphere models database
  stellar_atmosphere_model_database();
}



// GENERATE STELLAR SPECTRUM  ###########################################
int stellar_atmosphere_models::generate_bin_luminosity(
    const int source_type,  // Source identifier
    const double Tstar,     // Effective temperature of the star
    const double Rstar,     // Stellar radius
    const double Lstar,     // Total luminosity
    std::vector<double> &bin_luminosity)
{

  double Total_luminosity = Lstar;
  // Check that the total luminosity is close to the luminosity
  // calculated from 4Pi*R^2 sigma*T^4
  if (Tstar < 1000.0) {
    spdlog::error("{}: {}", "T<1000K, Source is not a star!", Tstar);
    return 1;
  }

  double L_Stefan_Bolt = 4.0 * M_PI * pconst.StefanBoltzmannConst()
                         * pow(Tstar, 4.0) * Rstar * pconst.Rsun() * Rstar
                         * pconst.Rsun();
  if (fabs(1.0 - L_Stefan_Bolt / Lstar) > 0.05 && !pconst.equalD(Lstar, 1.0)) {
    spdlog::warn(
        "Luminosities don't match! Lstar={} and L_Stefan-Bolt={}", Lstar,
        L_Stefan_Bolt);
    spdlog::warn(
        "generate stellar spectrum: Ignoring Lstar and using 4.Pi.R^2.sigma.T^4");
    Total_luminosity = L_Stefan_Bolt;
    // cerr <<": NOTE Rstar given will be scaled to give the requested
    // Lstar\n";
    //
    // If L>Lstar, then we want to multiply the radius by sqrt(Lstar/L)<1
    // to decrease the radius and give the requested Luminosity.
    // Maybe we should just bug out?
    // spdlog::error("{}: {}", "Lstar,Rstar,Tstar are inconsistent",Lstar/L);
    // L=sqrt(Lstar/L); // Radius can be multiplied by this below.
    //
    // else {
    //  L=1.0; // So that the radius is scaled by 1.0 below
    //}
  }

  stellar_model_datatype model;
  // Invoke the stellar atmosphere model for the given source type
  model = get_stellar_atmosphere_model(source_type);  // source type

  // check if the Tstar temperature is within the temperature range
  // of the model data.
  std::vector<std::vector<double> > model_data = model.data;
  std::vector<double> &first_model_entry       = model_data.front();
  std::vector<double> &last_model_entry        = model_data.back();
  double min_stellar_effective_temperature     = first_model_entry.front();
  double max_stellar_effective_temperature     = last_model_entry.front();

  if (Tstar < min_stellar_effective_temperature) {
    spdlog::error(
        "stellar atmosphere model: Tstar fall short of min SED temperature {} K",
        min_stellar_effective_temperature);
    return 1;
  }

  if (Tstar > max_stellar_effective_temperature) {
    spdlog::error(
        "stellar atmosphere model: Tstar exceeds max SED temperature {} K",
        max_stellar_effective_temperature);
    return 1;
  }

  // check if the number of spectral bins matches the energy bins we
  // are interested in.
  int N_spectral_bins = model_data[0].size() - 1;
  if (N_spectral_bins != N_energy_bins) {
    spdlog::error(
        "stellar atmosphere model: Energy bin count doesn't match spectral bin size {}",
        N_spectral_bins);
    return 1;
  }

  // To interpolate, first find the bounding temperatures for the given
  // star temperature in the stellar model.
  double T_lower = 0.0;
  double T_upper = 0.0;
  int T_index    = 0;
  for (; T_index < model_data.size() && Tstar > model_data[T_index][0];
       T_index++)
    ;
  T_lower = model_data[T_index - 1][0];
  T_upper = model_data[T_index][0];

  double frac_luminosity = 0.0;
  for (int j = 1; j < model_data[0].size(); j++) {
    frac_luminosity = model_data[T_index - 1][j]
                          * (1 - (Tstar - T_lower) / (T_upper - T_lower))
                      + model_data[T_index][j]
                            * (1 - (T_upper - Tstar) / (T_upper - T_lower));
    // multiply by the total luminosity to get erg/s/bin:
    bin_luminosity.push_back(frac_luminosity * Total_luminosity);
  }

#ifdef SAM_DEBUG
  mkdir("MPV10-Tables/stellar_model", 0777);
  star_info = {source_type, Tstar, Rstar, Lstar, L_Stefan_Bolt};
  // print to file photo-ionisation cross-section tables
  spdlog::debug("stellar atmosphere models: writting bin luminosity into file");
  print_bin_luminosity(
      model.info, star_info, bin_luminosity, energy_bins,
      "MPV10-Tables/stellar_model/bin_luminosity");
#endif

  return 0;
}


// #########################################################################
// Print bin luminosity (monochromatic luminosity) to file
void stellar_atmosphere_models::print_bin_luminosity(
    const std::string model_info,
    const star_datatype star_info,
    const std::vector<double> &bin_luminosity,
    const std::vector<std::vector<double> > &energy_bins,
    std::string filename)
{
  filename = filename + "_srctype" + std::to_string(star_info.Type) + ".txt";
  ofstream file;
  file.open(filename);
  file << "#FILE: Generated by PION - Stellar Atmosphere Model Module\n\n";
  file << "#COMMENT: Source id " << star_info.Type << endl;
  file << "#COMMENT: Teff " << star_info.Teff << " K" << endl;
  file << "#COMMENT: Radius " << star_info.Radius << " solar radii" << endl;
  file << "#COMMENT: Luminosity " << star_info.Luminosity << " ergs/s" << endl;
  file << "#COMMENT: Stefan Boltzmann Value " << star_info.Stefan_Boltzmann
       << " ergs/s" << endl;
  file << model_info << endl;
  file << "#UNIT: eV\teV\tegrs/s/bins" << endl;
  file << "#NAME: Bin_Min\tBin_Max\tBin_Luminosity" << endl;
  file << "#DATA:" << endl;
  for (size_t i = 0; i < bin_luminosity.size(); i++) {
    file << energy_bins[i][0] << "\t" << energy_bins[i][1] << "\t"
         << bin_luminosity[i];
    if (i == bin_luminosity.size() - 1)
      break;
    else
      file << endl;
  }
  file << '\n';
  file << '\n';
  file << "#COMMENT: Total fraction of Luminosity in the bins ";
  double tot_frac_L = 0.0;
  for (size_t i = 0; i < bin_luminosity.size(); i++) {
    tot_frac_L += bin_luminosity[i] / star_info.Luminosity;
  }
  file << tot_frac_L << endl;
  file.close();
}


// CATALOGUING STELLAR ATMOSPHERE  #######################################
// cataloguing data base
stellar_model_datatype stellar_atmosphere_models::get_stellar_atmosphere_model(
    int source_type)
{
  stellar_model_datatype model;
  if (source_type == RT_EFFECT_MP10_ATLAS_O3V) model = atlas_ckp00_g45;
  if (source_type == RT_EFFECT_MP10_POWR_WC) model = powr_mw_wc;
  if (source_type == RT_EFFECT_MP10_POWR_WNE) model = powr_mw_wne;
  return model;
}



// STELLAR ATMOSPHERE MODEL DATABASE  ####################################
void stellar_atmosphere_models::stellar_atmosphere_model_database()
{
  // This is binned flux divided by total flux. This basically give the
  // distribution of flux as the function of frequency. Here it

  atlas_ckp00_g45.info = "#COMMENT: SED - Atlas Model Atmospheres\n"
                         "#COMMENT: SED parameters:\n"
                         "#COMMENT: LOG Z = 0.0\n"
                         "#COMMENT: LOG G = 4.5\n";

  atlas_ckp00_g45.data = {
      {3.500000e+03, 2.751707e-13, 3.346807e-20, 7.924601e-28, 4.906625e-33,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {3.750000e+03, 4.961173e-12, 3.286473e-18, 7.567473e-27, 9.585228e-32,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {4.000000e+03, 1.159042e-11, 1.416902e-17, 4.063299e-26, 7.711038e-31,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {4.250000e+03, 2.144621e-11, 2.978469e-17, 1.291757e-25, 3.426732e-30,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {4.500000e+03, 6.476780e-11, 7.547997e-17, 7.595221e-25, 3.160981e-29,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {4.750000e+03, 4.550073e-10, 5.387727e-16, 2.037210e-23, 1.788657e-27,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {5.000000e+03, 1.848440e-09, 5.378956e-15, 3.021732e-22, 4.751925e-26,
       9.899458e-34, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {5.250000e+03, 5.660992e-09, 3.744297e-14, 3.419343e-21, 8.856541e-25,
       5.501881e-32, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {5.500000e+03, 2.114023e-08, 1.473938e-13, 2.836538e-20, 1.114482e-23,
       1.565294e-30, 6.831698e-35, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {5.750000e+03, 8.065811e-08, 6.106279e-13, 2.672711e-19, 1.527068e-22,
       4.456699e-29, 4.509702e-33, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {6.000000e+03, 2.932509e-07, 3.069979e-12, 2.302137e-18, 2.138810e-21,
       1.610339e-27, 2.842869e-31, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {6.250000e+03, 9.343025e-07, 1.196615e-11, 8.917174e-18, 1.198480e-20,
       1.854154e-26, 4.932123e-30, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {6.500000e+03, 2.589074e-06, 4.135545e-11, 3.828823e-17, 7.181923e-20,
       2.126998e-25, 8.195879e-29, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {6.750000e+03, 6.386693e-06, 1.253868e-10, 1.518028e-16, 3.818349e-19,
       2.001657e-24, 1.068220e-27, 1.176868e-34, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {7.000000e+03, 1.421380e-05, 3.388213e-10, 6.237183e-16, 2.029531e-18,
       1.755436e-23, 1.246821e-26, 3.366373e-33, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {7.250000e+03, 2.880783e-05, 7.943316e-10, 2.219834e-15, 8.931152e-18,
       1.166852e-22, 1.049273e-25, 4.727683e-32, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {7.500000e+03, 5.433699e-05, 1.825742e-09, 7.503535e-15, 3.656939e-17,
       6.925488e-22, 7.699856e-25, 5.481671e-31, 4.431440e-35, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {7.750000e+03, 9.816026e-05, 4.168347e-09, 2.510759e-14, 1.452845e-16,
       3.839772e-21, 5.163736e-24, 5.541156e-30, 7.011326e-34, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {8.000000e+03, 1.821182e-04, 9.536761e-09, 8.084908e-14, 5.444165e-16,
       1.929056e-20, 3.067425e-23, 4.724797e-29, 7.666891e-33, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {8.250000e+03, 4.117367e-04, 2.211019e-08, 2.381112e-13, 1.838659e-15,
       8.489371e-20, 1.569464e-22, 5.225850e-28, 5.423625e-31, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {8.500000e+03, 1.220193e-03, 5.236638e-08, 7.069488e-13, 6.188930e-15,
       1.056803e-18, 9.861903e-22, 1.597564e-26, 2.464543e-30, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {8.750000e+03, 3.641805e-03, 1.304731e-07, 2.278014e-12, 2.450384e-14,
       1.487386e-17, 3.333338e-20, 5.501265e-26, 1.014105e-29, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {9.000000e+03, 9.158199e-03, 3.420312e-07, 8.915459e-12, 1.074912e-12,
       3.477156e-17, 8.870933e-20, 1.939943e-25, 4.300311e-29, 2.502752e-34,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {9.250000e+03, 1.883707e-02, 8.619590e-07, 3.049067e-10, 1.944056e-12,
       7.835995e-17, 2.265526e-19, 6.562023e-25, 1.788220e-28, 2.700187e-33,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {9.500000e+03, 3.191380e-02, 1.921453e-06, 4.855836e-10, 3.446436e-12,
       1.732777e-16, 5.644982e-19, 2.249734e-24, 8.011867e-28, 2.161253e-32,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {9.750000e+03, 4.669413e-02, 3.782216e-06, 7.797817e-10, 6.200761e-12,
       4.009567e-16, 1.467119e-18, 8.514569e-24, 4.089232e-27, 1.761234e-31,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {1.000000e+04, 6.188109e-02, 6.799266e-06, 1.233760e-09, 1.108409e-11,
       9.578733e-16, 3.885575e-18, 3.368098e-23, 2.140522e-26, 1.347961e-30,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {1.025000e+04, 7.681605e-02, 1.156729e-05, 2.041051e-09, 2.114006e-11,
       2.490981e-15, 1.111918e-17, 1.397114e-22, 1.128120e-25, 9.729025e-30,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {1.050000e+04, 9.108995e-02, 1.926487e-05, 3.418607e-09, 4.107107e-11,
       6.544388e-15, 3.143879e-17, 5.542174e-22, 5.549911e-25, 6.360758e-29,
       8.061249e-34, 0.000000e+00, 0.000000e+00},
      {1.075000e+04, 1.048857e-01, 3.324899e-05, 5.716262e-09, 7.932011e-11,
       1.680771e-14, 8.443524e-17, 2.026806e-21, 2.469807e-24, 3.666940e-28,
       7.293805e-33, 0.000000e+00, 0.000000e+00},
      {1.100000e+04, 1.180374e-01, 6.589266e-05, 9.430215e-09, 1.498379e-10,
       4.147375e-14, 2.114439e-16, 6.713607e-21, 9.760361e-24, 1.834315e-27,
       4.963472e-32, 0.000000e+00, 0.000000e+00},
      {1.125000e+04, 1.305079e-01, 1.577974e-04, 1.515320e-08, 2.731085e-10,
       9.740000e-14, 4.887584e-16, 1.995216e-20, 3.413471e-23, 7.979229e-27,
       2.813145e-31, 0.000000e+00, 0.000000e+00},
      {1.150000e+04, 1.423366e-01, 3.894983e-04, 2.370397e-08, 4.831230e-10,
       2.216310e-13, 1.053853e-15, 5.432221e-20, 1.079215e-22, 3.075807e-26,
       1.375472e-30, 8.872075e-35, 0.000000e+00},
      {1.175000e+04, 1.535072e-01, 8.543302e-04, 3.661202e-08, 8.435606e-10,
       4.950557e-13, 2.163979e-15, 1.377147e-19, 3.123614e-22, 1.063771e-25,
       5.904733e-30, 8.817311e-34, 0.000000e+00},
      {1.200000e+04, 1.641602e-01, 1.624145e-03, 5.593229e-08, 1.449426e-09,
       1.078767e-12, 4.246385e-15, 3.253018e-19, 8.301990e-22, 3.321901e-25,
       2.246233e-29, 4.427302e-33, 0.000000e+00},
      {1.225000e+04, 1.742604e-01, 2.731697e-03, 8.330768e-08, 2.422998e-09,
       2.285470e-12, 7.922822e-15, 7.160139e-19, 2.035680e-21, 9.427323e-25,
       7.608530e-29, 1.790373e-32, 0.000000e+00},
      {1.250000e+04, 1.839635e-01, 4.189391e-03, 1.239890e-07, 4.053759e-09,
       4.792459e-12, 1.447517e-14, 1.524003e-18, 4.768503e-21, 2.505779e-24,
       2.367115e-28, 6.494988e-32, 0.000000e+00},
      {1.275000e+04, 1.932574e-01, 5.981690e-03, 1.849000e-07, 6.760232e-09,
       9.892730e-12, 2.629173e-14, 3.176970e-18, 1.078677e-20, 6.318830e-24,
       6.880567e-28, 2.164021e-31, 0.000000e+00},
      {1.300000e+04, 2.022091e-01, 8.100342e-03, 2.724176e-07, 1.108628e-08,
       1.988145e-11, 4.717626e-14, 6.439445e-18, 2.350323e-20, 1.517604e-23,
       1.875096e-27, 6.639634e-31, 0.000000e+00},
      {1.400000e+04, 2.349437e-01, 1.936139e-02, 1.211481e-06, 7.264962e-08,
       2.561653e-10, 5.281773e-13, 1.160897e-16, 5.423667e-19, 4.562912e-22,
       7.656405e-26, 3.761068e-29, 2.571989e-34},
      {1.500000e+04, 2.630610e-01, 3.411998e-02, 4.608076e-06, 3.756686e-07,
       2.170476e-09, 5.981525e-12, 2.369529e-15, 1.541807e-17, 1.826391e-20,
       3.927580e-24, 2.119691e-27, 2.122086e-32},
      {1.600000e+04, 2.867101e-01, 5.077879e-02, 1.443370e-05, 1.510701e-06,
       1.258901e-08, 4.086674e-11, 2.923069e-14, 2.792789e-16, 5.449428e-19,
       2.048816e-22, 1.620229e-25, 2.230164e-30},
      {1.700000e+04, 3.060918e-01, 6.839525e-02, 3.724574e-05, 4.788728e-06,
       5.474012e-08, 1.835237e-10, 2.100415e-13, 2.754865e-15, 8.312139e-18,
       5.427729e-21, 6.598768e-24, 1.893374e-28},
      {1.800000e+04, 3.217211e-01, 8.622793e-02, 7.960182e-05, 1.233731e-05,
       1.887290e-07, 6.513338e-10, 1.083489e-12, 1.817424e-14, 7.637275e-17,
       7.572177e-20, 1.111246e-22, 6.001972e-27},
      {1.900000e+04, 3.341145e-01, 1.038561e-01, 1.474157e-04, 2.684964e-05,
       5.328618e-07, 1.890794e-09, 4.355125e-12, 9.054460e-14, 5.107470e-16,
       7.325396e-19, 1.044902e-21, 9.562346e-26},
      {2.000000e+04, 3.438727e-01, 1.210431e-01, 2.464805e-04, 5.224159e-05,
       1.320112e-06, 5.049390e-09, 1.591617e-11, 4.048120e-13, 3.011862e-15,
       6.048776e-18, 7.086695e-21, 9.726900e-25},
      {2.100000e+04, 3.516871e-01, 1.375938e-01, 3.865648e-04, 9.394586e-05,
       2.968735e-06, 1.234736e-08, 5.208193e-11, 1.586802e-12, 1.528536e-14,
       4.221743e-17, 3.701822e-20, 7.100133e-24},
      {2.200000e+04, 3.579895e-01, 1.533178e-01, 5.790629e-04, 1.603721e-04,
       6.274994e-06, 2.923084e-08, 1.652412e-10, 5.945004e-12, 7.390135e-14,
       2.783104e-16, 1.680412e-19, 4.372153e-23},
      {2.300000e+04, 3.632330e-01, 1.683000e-01, 8.465539e-04, 2.655316e-04,
       1.277240e-05, 6.939128e-08, 5.187456e-10, 2.121407e-11, 3.305718e-13,
       1.634283e-15, 6.960306e-19, 2.366259e-22},
      {2.400000e+04, 3.675153e-01, 1.821706e-01, 1.226039e-03, 4.357357e-04,
       2.576333e-05, 1.684018e-07, 1.655121e-09, 7.347247e-11, 1.413203e-12,
       9.009425e-15, 2.696291e-18, 1.195983e-21},
      {2.500000e+04, 3.709106e-01, 1.947883e-01, 1.780636e-03, 7.197008e-04,
       5.214699e-05, 4.317062e-07, 5.456690e-09, 2.464978e-10, 5.669563e-12,
       4.490705e-14, 1.053982e-17, 6.135622e-21},
      {2.600000e+04, 3.734070e-01, 2.060050e-01, 2.594443e-03, 1.194594e-03,
       1.052101e-04, 1.129566e-06, 1.795338e-08, 7.704201e-10, 2.080713e-11,
       1.992185e-13, 4.211267e-17, 3.163109e-20},
      {2.700000e+04, 3.749657e-01, 2.157038e-01, 3.757661e-03, 1.967893e-03,
       2.079074e-04, 2.980871e-06, 5.764587e-08, 2.284114e-09, 7.128080e-11,
       8.091092e-13, 1.620417e-16, 1.585085e-19},
      {2.800000e+04, 3.753440e-01, 2.238699e-01, 5.370611e-03, 3.188336e-03,
       4.027629e-04, 7.637324e-06, 1.762344e-07, 6.596640e-09, 2.359030e-10,
       3.142000e-12, 6.443179e-16, 8.440172e-19},
      {2.900000e+04, 3.742495e-01, 2.304200e-01, 7.622913e-03, 5.133786e-03,
       7.813685e-04, 1.925960e-05, 5.305257e-07, 2.122972e-08, 8.648839e-10,
       1.338065e-11, 2.673620e-15, 4.644036e-18},
      {3.000000e+04, 3.713424e-01, 2.352044e-01, 1.084561e-02, 8.319902e-03,
       1.527945e-03, 4.801628e-05, 1.638545e-06, 8.091003e-08, 3.613906e-09,
       6.273959e-11, 1.115547e-14, 2.612443e-17},
      {3.100000e+04, 3.661386e-01, 2.379136e-01, 1.548690e-02, 1.352550e-02,
       2.927910e-03, 1.198204e-04, 5.283369e-06, 3.500729e-07, 1.590667e-08,
       2.997544e-10, 4.659461e-14, 1.516049e-16},
      {3.200000e+04, 3.583166e-01, 2.383179e-01, 2.185713e-02, 2.148928e-02,
       5.259423e-03, 2.909920e-04, 1.683432e-05, 1.474287e-06, 6.557205e-08,
       1.343997e-09, 1.834694e-13, 8.295517e-16},
      {3.300000e+04, 3.480040e-01, 2.362164e-01, 2.989753e-02, 3.246263e-02,
       8.616601e-03, 6.689834e-04, 5.059997e-05, 5.425473e-06, 2.417180e-07,
       5.433593e-09, 6.423763e-13, 3.871209e-15},
      {3.400000e+04, 3.361738e-01, 2.324139e-01, 3.899143e-02, 4.566584e-02,
       1.275838e-02, 1.434153e-03, 1.421757e-04, 1.693686e-05, 7.456559e-07,
       1.824617e-08, 1.921835e-12, 1.474044e-14},
      {3.500000e+04, 3.233471e-01, 2.271292e-01, 4.857882e-02, 6.015342e-02,
       1.741049e-02, 2.990973e-03, 3.915977e-04, 4.705300e-05, 1.958759e-06,
       5.212892e-08, 5.190843e-12, 4.820434e-14},
      {3.600000e+04, 3.100697e-01, 2.207284e-01, 5.782988e-02, 7.466257e-02,
       2.227547e-02, 6.162707e-03, 9.948310e-04, 1.170736e-04, 4.712003e-06,
       1.373543e-07, 1.303082e-11, 1.390160e-13},
      {3.700000e+04, 2.967351e-01, 2.134993e-01, 6.583121e-02, 8.808684e-02,
       2.713502e-02, 1.189268e-02, 2.112064e-03, 2.506968e-04, 1.079810e-05,
       3.386804e-07, 3.044696e-11, 3.644106e-13},
      {3.800000e+04, 2.836270e-01, 2.057812e-01, 7.210509e-02, 9.982315e-02,
       3.186588e-02, 2.046797e-02, 3.719283e-03, 4.572879e-04, 2.396603e-05,
       7.676598e-07, 6.701843e-11, 8.962347e-13},
      {3.900000e+04, 2.708792e-01, 1.978364e-01, 7.676125e-02, 1.099285e-01,
       3.645517e-02, 3.126734e-02, 5.631455e-03, 7.319517e-04, 5.629582e-05,
       1.575250e-06, 1.382036e-10, 2.063183e-12},
      {4.000000e+04, 2.585942e-01, 1.898527e-01, 8.022837e-02, 1.187604e-01,
       4.093087e-02, 4.320394e-02, 7.653528e-03, 1.068410e-03, 1.521625e-04,
       2.964106e-06, 2.653361e-10, 4.468873e-12},
      {4.100000e+04, 2.468327e-01, 1.819691e-01, 8.292124e-02, 1.266790e-01,
       4.533527e-02, 5.525636e-02, 9.652751e-03, 1.465745e-03, 4.189528e-04,
       5.315868e-06, 4.907407e-10, 9.561195e-12},
      {4.200000e+04, 2.356018e-01, 1.742881e-01, 8.512051e-02, 1.339574e-01,
       4.969032e-02, 6.667101e-02, 1.154629e-02, 1.924367e-03, 1.028595e-03,
       9.769702e-06, 9.237160e-10, 2.129768e-11},
      {4.300000e+04, 2.249233e-01, 1.668682e-01, 8.693221e-02, 1.406838e-01,
       5.399274e-02, 7.706307e-02, 1.331858e-02, 2.447659e-03, 2.167130e-03,
       2.009114e-05, 1.834702e-09, 5.075074e-11},
      {4.400000e+04, 2.147393e-01, 1.597484e-01, 8.845286e-02, 1.468450e-01,
       5.818903e-02, 8.632861e-02, 1.497649e-02, 3.041773e-03, 3.973482e-03,
       4.604561e-05, 3.908514e-09, 1.305226e-10},
      {4.500000e+04, 2.050111e-01, 1.529011e-01, 8.966990e-02, 1.524399e-01,
       6.224274e-02, 9.455588e-02, 1.657247e-02, 3.712941e-03, 6.460184e-03,
       1.054762e-04, 8.920415e-09, 3.555624e-10},
      {4.600000e+04, 1.957177e-01, 1.463509e-01, 9.058364e-02, 1.574376e-01,
       6.612194e-02, 1.018979e-01, 1.811302e-02, 4.460318e-03, 9.539840e-03,
       2.221415e-04, 2.109918e-08, 9.673535e-10},
      {4.700000e+04, 1.868699e-01, 1.400899e-01, 9.122714e-02, 1.618303e-01,
       6.978098e-02, 1.085085e-01, 1.964645e-02, 5.293287e-03, 1.304722e-02,
       4.189684e-04, 4.898676e-08, 2.469066e-09},
      {4.800000e+04, 1.784337e-01, 1.341223e-01, 9.162453e-02, 1.656696e-01,
       7.320753e-02, 1.145195e-01, 2.117477e-02, 6.213852e-03, 1.681295e-02,
       7.123481e-04, 1.069046e-07, 5.733245e-09},
      {4.900000e+04, 1.704123e-01, 1.284579e-01, 9.179958e-02, 1.690046e-01,
       7.643031e-02, 1.200407e-01, 2.271264e-02, 7.217624e-03, 2.064876e-02,
       1.105725e-03, 2.151757e-07, 1.214172e-08},
  };

  // ###########################################################################
  powr_mw_wc.info = "#COMMENT: SED - PoWR Model Atmospheres\n"
                    "#COMMENT: SED parameters:\n"
                    "#COMMENT: Metallicity = MW\n"
                    "#COMMENT: Composition = WC\n"
                    "#COMMENT: Mdot = -5.0\n";

  powr_mw_wc.data = {
      {3.981000e+04, 2.355263e-01, 1.608154e-01, 1.648405e-01, 1.419853e-01,
       9.551552e-03, 7.850990e-03, 4.481900e-04, 5.409203e-05, 3.391179e-06,
       2.585601e-11, 1.035232e-16, 3.088562e-18},
      {4.466800e+04, 2.166053e-01, 1.423459e-01, 1.672898e-01, 1.930928e-01,
       2.225192e-02, 1.573238e-02, 5.823392e-04, 1.448024e-04, 1.108820e-05,
       2.432742e-11, 2.109766e-14, 1.012455e-16},
      {5.011900e+04, 1.990179e-01, 1.324792e-01, 1.664395e-01, 2.247348e-01,
       4.421890e-02, 2.837398e-02, 7.633621e-04, 2.992617e-04, 2.575050e-05,
       8.884223e-11, 5.766241e-14, 1.248448e-15},
      {5.623400e+04, 1.706344e-01, 1.183240e-01, 1.464002e-01, 2.423777e-01,
       9.069992e-02, 6.444339e-02, 1.561568e-03, 1.475314e-03, 7.933296e-05,
       2.553843e-12, 3.159718e-13, 1.965371e-14},
      {6.309600e+04, 1.566360e-01, 1.026206e-01, 1.362234e-01, 2.219507e-01,
       1.163405e-01, 1.112092e-01, 6.839990e-03, 8.995903e-03, 1.820588e-04,
       5.589841e-11, 3.623696e-13, 5.218980e-14},
      {7.079500e+04, 1.444797e-01, 9.492018e-02, 1.157632e-01, 1.930350e-01,
       1.150329e-01, 1.564119e-01, 2.635599e-02, 2.754755e-02, 1.260687e-03,
       6.217428e-09, 2.934894e-11, 1.701221e-12},
      {7.943300e+04, 1.283364e-01, 8.330299e-02, 1.003263e-01, 1.719913e-01,
       1.010927e-01, 1.818799e-01, 6.238683e-02, 5.417704e-02, 5.478334e-03,
       7.579129e-07, 2.253814e-10, 1.182141e-11},
      {8.912500e+04, 1.158556e-01, 7.522137e-02, 9.089152e-02, 1.606837e-01,
       9.551927e-02, 1.900532e-01, 8.481502e-02, 7.401196e-02, 9.542854e-03,
       4.707603e-04, 3.946620e-10, 5.938894e-11},
      {1.000000e+05, 1.070630e-01, 7.288419e-02, 8.765157e-02, 1.574682e-01,
       9.469550e-02, 1.969723e-01, 9.107931e-02, 8.017908e-02, 1.220449e-02,
       1.232378e-03, 8.645277e-10, 1.089568e-10},
      {1.122020e+05, 1.032878e-01, 6.986787e-02, 8.627367e-02, 1.571880e-01,
       9.355837e-02, 2.005736e-01, 9.686782e-02, 8.293762e-02, 1.487400e-02,
       3.094915e-03, 3.922211e-10, 2.326187e-11},
      {1.258920e+05, 9.973399e-02, 6.743440e-02, 7.948776e-02, 1.503431e-01,
       9.155656e-02, 2.017416e-01, 1.064466e-01, 8.874655e-02, 1.896792e-02,
       5.915258e-03, 3.392039e-10, 1.823607e-11},
      {1.412540e+05, 9.615302e-02, 6.539379e-02, 7.575378e-02, 1.447587e-01,
       8.801759e-02, 2.030264e-01, 1.129641e-01, 9.470421e-02, 2.329852e-02,
       8.521439e-03, 2.158501e-10, 8.136951e-12},
      {1.584890e+05, 9.250999e-02, 6.441234e-02, 7.572292e-02, 1.385209e-01,
       8.432154e-02, 2.037375e-01, 1.172750e-01, 9.927630e-02, 2.789178e-02,
       1.026964e-02, 2.065053e-10, 1.813235e-12},
      {1.778280e+05, 9.650846e-02, 6.471186e-02, 7.499873e-02, 1.358055e-01,
       8.031088e-02, 1.979799e-01, 1.191151e-01, 1.018566e-01, 3.204176e-02,
       1.297411e-02, 2.273344e-10, 3.477148e-12},
      {1.995260e+05, 1.165396e-01, 8.294175e-02, 9.056321e-02, 1.527536e-01,
       8.738929e-02, 1.893407e-01, 8.316400e-02, 7.723900e-02, 1.363211e-02,
       3.909717e-05, 2.440016e-09, 1.274872e-10},
  };

  // ###########################################################################

  powr_mw_wne.info = "#COMMENT: SED - PoWR Model Atmospheres\n"
                     "#COMMENT: SED parameters:\n"
                     "#COMMENT: Metallicity = MW\n"
                     "#COMMENT: Composition = WNE\n"
                     "#COMMENT: Mdot = -5.0\n";

  powr_mw_wne.data = {
      {3.162300e+04, 2.525916e-01, 2.031145e-01, 1.241354e-01, 5.826659e-02,
       1.078467e-03, 7.776509e-04, 7.734731e-05, 4.030966e-06, 4.733242e-08,
       8.535614e-13, 2.277898e-16, 4.622607e-98},
      {3.548100e+04, 2.466044e-01, 1.829740e-01, 1.360527e-01, 1.182760e-01,
       5.721356e-03, 4.997405e-03, 2.663367e-04, 4.021262e-05, 1.225686e-06,
       3.705015e-10, 1.014047e-14, 1.383210e-17},
      {3.981100e+04, 2.057306e-01, 1.492018e-01, 1.355348e-01, 1.987535e-01,
       3.877800e-02, 3.019575e-02, 6.095640e-04, 3.868590e-04, 4.574774e-05,
       7.775775e-09, 1.097478e-13, 4.650234e-98},
      {4.466800e+04, 1.682268e-01, 1.247408e-01, 1.234082e-01, 2.282029e-01,
       9.213572e-02, 7.165150e-02, 1.106182e-03, 1.931708e-03, 2.700977e-04,
       1.328640e-08, 1.477136e-13, 1.151488e-18},
      {5.011900e+04, 1.417825e-01, 1.104620e-01, 1.120463e-01, 2.165444e-01,
       1.171870e-01, 1.378130e-01, 5.398420e-03, 7.819933e-03, 8.903380e-04,
       5.746090e-05, 7.485959e-14, 9.446002e-15},
      {5.623400e+04, 1.192687e-01, 9.448859e-02, 9.856371e-02, 1.987387e-01,
       1.139313e-01, 1.963040e-01, 3.021572e-02, 2.399424e-02, 1.977289e-03,
       6.290654e-04, 3.084660e-12, 4.724997e-13},
      {6.309600e+04, 1.003090e-01, 7.933040e-02, 8.606710e-02, 1.768602e-01,
       1.038398e-01, 2.198173e-01, 7.684674e-02, 4.857000e-02, 4.492434e-03,
       2.024400e-03, 4.998584e-12, 1.551084e-12},
      {7.079500e+04, 8.898976e-02, 6.668837e-02, 7.539559e-02, 1.572540e-01,
       9.551896e-02, 2.049180e-01, 1.092443e-01, 9.332182e-02, 1.513654e-02,
       5.111547e-03, 6.024827e-12, 5.159384e-12},
      {7.943300e+04, 7.949728e-02, 5.615309e-02, 6.573961e-02, 1.390402e-01,
       8.780787e-02, 1.862790e-01, 1.175643e-01, 1.463003e-01, 3.456886e-02,
       9.230116e-03, 1.065080e-11, 1.582081e-11},
      {8.912500e+04, 7.319311e-02, 5.016304e-02, 6.110889e-02, 1.315684e-01,
       8.570333e-02, 1.838792e-01, 1.164693e-01, 1.649695e-01, 4.916972e-02,
       1.256435e-02, 1.284173e-11, 1.602201e-11},
      {1.000000e+05, 7.008400e-02, 4.711622e-02, 5.929720e-02, 1.314199e-01,
       8.779920e-02, 1.867595e-01, 1.140371e-01, 1.653391e-01, 5.565527e-02,
       1.602209e-02, 8.018307e-12, 6.681273e-12},
      {1.122020e+05, 6.544545e-02, 4.503570e-02, 5.575255e-02, 1.259507e-01,
       8.529000e-02, 1.830358e-01, 1.156897e-01, 1.750312e-01, 6.416093e-02,
       2.033770e-02, 3.809715e-13, 2.884817e-12},
      {1.258920e+05, 6.172388e-02, 4.281856e-02, 5.205158e-02, 1.161378e-01,
       7.965428e-02, 1.779078e-01, 1.171814e-01, 1.876709e-01, 7.633891e-02,
       2.632282e-02, 2.319446e-11, 1.956333e-11},
      {1.412540e+05, 5.832673e-02, 3.998482e-02, 4.725505e-02, 1.059227e-01,
       7.479165e-02, 1.752939e-01, 1.195907e-01, 1.986308e-01, 8.806594e-02,
       3.156194e-02, 4.257595e-11, 7.129099e-11},
      {1.584890e+05, 5.349620e-02, 3.816621e-02, 4.380935e-02, 9.790540e-02,
       7.059083e-02, 1.718891e-01, 1.193419e-01, 2.103156e-01, 9.723933e-02,
       3.753570e-02, 5.455531e-11, 1.256981e-10},
      {1.778280e+05, 5.061889e-02, 3.594386e-02, 4.052773e-02, 9.129236e-02,
       6.743654e-02, 1.695749e-01, 1.193970e-01, 2.149812e-01, 1.094884e-01,
       4.228338e-02, 8.546668e-11, 2.499867e-10},
      {1.995260e+05, 7.265299e-03, 8.326230e-03, 1.186835e-02, 3.348831e-02,
       2.670587e-02, 7.929765e-02, 6.442551e-02, 8.773520e-02, 1.127914e-01,
       8.452418e-02, 8.453374e-02, 6.796729e-02},
  };

  // ###########################################################################
}
