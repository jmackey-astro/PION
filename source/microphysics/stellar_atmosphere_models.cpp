/**
 *  \file     stellar_atmosphere_models.cpp
 *  \author   Arun Mathew
 *  \date     05-07-2023
 **/

#include "stellar_atmosphere_models.h"

#define SAM_DEBUG

stellar_atmosphere_models::stellar_atmosphere_models() {}
stellar_atmosphere_models::~stellar_atmosphere_models() {}

// SETTING UP STELLAR ATMOSPHERE MODELS ###################################
void stellar_atmosphere_models::setup_stellar_atmosphere_models(
    std::vector<std::vector<double> > &Ebins,  // Energy bins
    int &N_ebins,                              // Number of energy bins
    double &Emax  // Maximum photo-ionisation energy
)
{

  spdlog::info("Setting up stellar atmosphere module");

  // Define Energy bins here.
  energy_bins = {
      {7.640000e+00, 1.120000e+01}, {1.120000e+01, 1.360000e+01},
      {1.360000e+01, 1.460000e+01}, {1.460000e+01, 1.630000e+01},
      {1.630000e+01, 2.156000e+01}, {2.156000e+01, 2.460000e+01},
      {2.460000e+01, 3.065000e+01}, {3.065000e+01, 3.510000e+01},
      {3.510000e+01, 4.096000e+01}, {4.096000e+01, 4.789000e+01},
      {4.789000e+01, 5.440000e+01}, {5.440000e+01, 6.450000e+01},
      {6.450000e+01, 7.700000e+01},
  };

  // Get number of energy bins
  N_energy_bins = energy_bins.size();

  // passing energy bin info
  Ebins   = energy_bins;
  N_ebins = N_energy_bins;

  // Get photoionisation maximum energy
  const std::vector<double> &last_bin = energy_bins.back();
  Emax                                = last_bin.back();

  // Initializing stellar atmosphere models database
  stellar_atmosphere_model_database();
}



// GENERATE STELLAR SPECTRUM  ###########################################
int stellar_atmosphere_models::generate_bin_luminosity(
    const int source_type,  // Source identifier
    const double Tstar,     // Effective temperature of the star
    const double Rstar,     // Stellar radius
    const double Lstar,     // Total luminosity
    std::vector<double> &bin_luminosity)
{

  double Total_luminosity = Lstar;
  // Check that the total luminosity is close to the luminosity
  // calculated from 4Pi*R^2 sigma*T^4
  if (Tstar < 1000.0) {
    spdlog::error("{}: {}", "T<1000K, Source is not a star!", Tstar);
    return 1;
  }

  double L_Stefan_Bolt = 4.0 * M_PI * pconst.StefanBoltzmannConst()
                         * pow(Tstar, 4.0) * Rstar * pconst.Rsun() * Rstar
                         * pconst.Rsun();
  if (fabs(1.0 - L_Stefan_Bolt / Lstar) > 0.05 && !pconst.equalD(Lstar, 1.0)) {
    spdlog::warn(
        "Luminosities don't match! Lstar={} and L_Stefan-Bolt={}", Lstar,
        L_Stefan_Bolt);
    spdlog::warn(
        "generate stellar spectrum: Ignoring Lstar and using 4.Pi.R^2.sigma.T^4");
    Total_luminosity = L_Stefan_Bolt;
    // cerr <<": NOTE Rstar given will be scaled to give the requested
    // Lstar\n";
    //
    // If L>Lstar, then we want to multiply the radius by sqrt(Lstar/L)<1
    // to decrease the radius and give the requested Luminosity.
    // Maybe we should just bug out?
    // spdlog::error("{}: {}", "Lstar,Rstar,Tstar are inconsistent",Lstar/L);
    // L=sqrt(Lstar/L); // Radius can be multiplied by this below.
    //
    // else {
    //  L=1.0; // So that the radius is scaled by 1.0 below
    //}
  }

  stellar_model_datatype model;
  // Invoke the stellar atmosphere model for the given source type
  model = get_stellar_atmosphere_model(source_type);  // source type

  // check if the Tstar temperature is within the temperature range
  // of the model data.
  std::vector<std::vector<double> > model_data = model.data;
  std::vector<double> &first_model_entry       = model_data.front();
  std::vector<double> &last_model_entry        = model_data.back();
  double min_stellar_effective_temperature     = first_model_entry.front();
  double max_stellar_effective_temperature     = last_model_entry.front();

  if (Tstar < min_stellar_effective_temperature) {
    spdlog::error(
        "SED: Tstar fall short of min SED temperature {} K",
        min_stellar_effective_temperature);
    return 1;
  }

  if (Tstar > max_stellar_effective_temperature) {
    spdlog::error(
        "SED: Tstar exceeds max SED temperature {} K",
        max_stellar_effective_temperature);
    return 1;
  }

  // check if the number of spectral bins matches the energy bins we
  // are interested in.
  int N_spectral_bins = model_data[0].size() - 1;
  if (N_spectral_bins != N_energy_bins) {
    spdlog::error(
        "SED: Energy bin count doesn't match spectral bin size {}",
        N_spectral_bins);
    return 1;
  }

  // To interpolate, first find the bounding temperatures for the given
  // star temperature in the stellar model.
  double T_lower = 0.0;
  double T_upper = 0.0;
  int T_index    = 0;
  for (; T_index < model_data.size() && Tstar > model_data[T_index][0];
       T_index++)
    ;
  T_lower = model_data[T_index - 1][0];
  T_upper = model_data[T_index][0];

  double frac_luminosity = 0.0;
  for (int j = 1; j < model_data[0].size(); j++) {
    frac_luminosity = model_data[T_index - 1][j]
                          * (1 - (Tstar - T_lower) / (T_upper - T_lower))
                      + model_data[T_index][j]
                            * (1 - (T_upper - Tstar) / (T_upper - T_lower));
    // multiply by the total luminosity to get erg/s/bin:
    bin_luminosity.push_back(frac_luminosity * Total_luminosity);
  }

#ifdef SAM_DEBUG
  mkdir("MPV10-Tables/stellar_model", 0777);
  star_info = {source_type, Tstar, Rstar, Lstar, L_Stefan_Bolt};
  // print to file photo-ionisation cross-section tables
  spdlog::debug("SED: writting bin luminosity into file");
  print_bin_luminosity(
      model.info, star_info, bin_luminosity, energy_bins,
      "MPV10-Tables/stellar_model/bin_luminosity");
#endif

  return 0;
}


// #########################################################################
// Print bin luminosity (monochromatic luminosity) to file
void stellar_atmosphere_models::print_bin_luminosity(
    const std::string model_info,
    const star_datatype star_info,
    const std::vector<double> &bin_luminosity,
    const std::vector<std::vector<double> > &energy_bins,
    std::string filename)
{
  filename = filename + "_srctype" + std::to_string(star_info.Type) + ".txt";
  ofstream file;
  file.open(filename);
  file << "#FILE: Generated by PION - Stellar Atmosphere Model Module\n\n";
  file << "#COMMENT: Source id " << star_info.Type << endl;
  file << "#COMMENT: Teff " << star_info.Teff << " K" << endl;
  file << "#COMMENT: Radius " << star_info.Radius << " solar radii" << endl;
  file << "#COMMENT: Luminosity " << star_info.Luminosity << " ergs/s" << endl;
  file << "#COMMENT: Stefan Boltzmann Value " << star_info.Stefan_Boltzmann
       << " ergs/s" << endl;
  file << model_info << endl;
  file << "#UNIT: eV\teV\tegrs/s/bins" << endl;
  file << "#NAME: Bin_Min\tBin_Max\tBin_Luminosity" << endl;
  file << "#DATA:" << endl;
  for (size_t i = 0; i < bin_luminosity.size(); i++) {
    file << energy_bins[i][0] << "\t" << energy_bins[i][1] << "\t"
         << bin_luminosity[i];
    if (i == bin_luminosity.size() - 1)
      break;
    else
      file << endl;
  }
  file << '\n';
  file << '\n';
  file << "#COMMENT: Total fraction of Luminosity in the bins ";
  double tot_frac_L = 0.0;
  for (size_t i = 0; i < bin_luminosity.size(); i++) {
    tot_frac_L += bin_luminosity[i] / star_info.Luminosity;
  }
  file << tot_frac_L << endl;
  file.close();
}


// CATALOGUING STELLAR ATMOSPHERE  #######################################
// cataloguing data base
stellar_model_datatype stellar_atmosphere_models::get_stellar_atmosphere_model(
    int source_type)
{
  stellar_model_datatype model;
  if (source_type == RT_EFFECT_MP10_ATLAS_O3V) model = atlas_ckp00_g45;
  if (source_type == RT_EFFECT_MP10_POWR_WC) model = powr_mw_wc;
  if (source_type == RT_EFFECT_MP10_POWR_WNE) model = powr_mw_wne;
  if (source_type == RT_EFFECT_MP10_BLACKBODY) {
    spdlog::info("Setting up Blackbody SED");
    model = blackbody;
  }
  return model;
}



// STELLAR ATMOSPHERE MODEL DATABASE  ####################################
void stellar_atmosphere_models::stellar_atmosphere_model_database()
{
  // This is binned flux divided by total flux. This basically give the
  // distribution of flux as the function of frequency. Here it

  atlas_ckp00_g45.info = "#COMMENT: SED - Atlas Model Atmospheres\n"
                         "#COMMENT: SED parameters:\n"
                         "#COMMENT: LOG Z = 0.0\n"
                         "#COMMENT: LOG G = 4.5\n";

  atlas_ckp00_g45.data = {
      {3.500000e+03, 2.751707e-13, 3.346807e-20, 7.924601e-28, 4.906625e-33,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {3.750000e+03, 4.961173e-12, 3.286473e-18, 7.567473e-27, 9.585228e-32,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {4.000000e+03, 1.159042e-11, 1.416902e-17, 4.063299e-26, 7.711038e-31,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {4.250000e+03, 2.144621e-11, 2.978469e-17, 1.291757e-25, 3.426732e-30,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {4.500000e+03, 6.476780e-11, 7.547997e-17, 7.595221e-25, 3.160981e-29,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {4.750000e+03, 4.550073e-10, 5.387727e-16, 2.037210e-23, 1.788657e-27,
       0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {5.000000e+03, 1.848440e-09, 5.378956e-15, 3.021732e-22, 4.751925e-26,
       9.899458e-34, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {5.250000e+03, 5.660992e-09, 3.744297e-14, 3.419343e-21, 8.856541e-25,
       5.501881e-32, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {5.500000e+03, 2.114023e-08, 1.473938e-13, 2.836538e-20, 1.114482e-23,
       1.565294e-30, 6.831698e-35, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {5.750000e+03, 8.065811e-08, 6.106279e-13, 2.672711e-19, 1.527068e-22,
       4.456699e-29, 4.509702e-33, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {6.000000e+03, 2.932509e-07, 3.069979e-12, 2.302137e-18, 2.138810e-21,
       1.610339e-27, 2.842869e-31, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {6.250000e+03, 9.343025e-07, 1.196615e-11, 8.917174e-18, 1.198480e-20,
       1.854154e-26, 4.932123e-30, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {6.500000e+03, 2.589074e-06, 4.135545e-11, 3.828823e-17, 7.181923e-20,
       2.126998e-25, 8.195879e-29, 0.000000e+00, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {6.750000e+03, 6.386693e-06, 1.253868e-10, 1.518028e-16, 3.818349e-19,
       2.001657e-24, 1.068220e-27, 1.176868e-34, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {7.000000e+03, 1.421380e-05, 3.388213e-10, 6.237183e-16, 2.029531e-18,
       1.755436e-23, 1.246821e-26, 3.366373e-33, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {7.250000e+03, 2.880783e-05, 7.943316e-10, 2.219834e-15, 8.931152e-18,
       1.166852e-22, 1.049273e-25, 4.727683e-32, 0.000000e+00, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {7.500000e+03, 5.433699e-05, 1.825742e-09, 7.503535e-15, 3.656939e-17,
       6.925488e-22, 7.699856e-25, 5.481671e-31, 4.431440e-35, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {7.750000e+03, 9.816026e-05, 4.168347e-09, 2.510759e-14, 1.452845e-16,
       3.839772e-21, 5.163736e-24, 5.541156e-30, 7.011326e-34, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {8.000000e+03, 1.821182e-04, 9.536761e-09, 8.084908e-14, 5.444165e-16,
       1.929056e-20, 3.067425e-23, 4.724797e-29, 7.666891e-33, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {8.250000e+03, 4.117367e-04, 2.211019e-08, 2.381112e-13, 1.838659e-15,
       8.489371e-20, 1.569464e-22, 5.225850e-28, 5.423625e-31, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {8.500000e+03, 1.220193e-03, 5.236638e-08, 7.069488e-13, 6.188930e-15,
       1.056803e-18, 9.861903e-22, 1.597564e-26, 2.464543e-30, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {8.750000e+03, 3.641805e-03, 1.304731e-07, 2.278014e-12, 2.450384e-14,
       1.487386e-17, 3.333338e-20, 5.501265e-26, 1.014105e-29, 0.000000e+00,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {9.000000e+03, 9.158199e-03, 3.420312e-07, 8.915459e-12, 1.074912e-12,
       3.477156e-17, 8.870933e-20, 1.939943e-25, 4.300311e-29, 2.502752e-34,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {9.250000e+03, 1.883707e-02, 8.619590e-07, 3.049067e-10, 1.944056e-12,
       7.835995e-17, 2.265526e-19, 6.562023e-25, 1.788220e-28, 2.700187e-33,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {9.500000e+03, 3.191380e-02, 1.921453e-06, 4.855836e-10, 3.446436e-12,
       1.732777e-16, 5.644982e-19, 2.249734e-24, 8.011867e-28, 2.161253e-32,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {9.750000e+03, 4.669413e-02, 3.782216e-06, 7.797817e-10, 6.200761e-12,
       4.009567e-16, 1.467119e-18, 8.514569e-24, 4.089232e-27, 1.761234e-31,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {1.000000e+04, 6.188109e-02, 6.799266e-06, 1.233760e-09, 1.108409e-11,
       9.578733e-16, 3.885575e-18, 3.368098e-23, 2.140522e-26, 1.347961e-30,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {1.025000e+04, 7.681605e-02, 1.156729e-05, 2.041051e-09, 2.114006e-11,
       2.490981e-15, 1.111918e-17, 1.397114e-22, 1.128120e-25, 9.729025e-30,
       0.000000e+00, 0.000000e+00, 0.000000e+00},
      {1.050000e+04, 9.108995e-02, 1.926487e-05, 3.418607e-09, 4.107107e-11,
       6.544388e-15, 3.143879e-17, 5.542174e-22, 5.549911e-25, 6.360758e-29,
       8.061249e-34, 0.000000e+00, 0.000000e+00},
      {1.075000e+04, 1.048857e-01, 3.324899e-05, 5.716262e-09, 7.932011e-11,
       1.680771e-14, 8.443524e-17, 2.026806e-21, 2.469807e-24, 3.666940e-28,
       7.293805e-33, 0.000000e+00, 0.000000e+00},
      {1.100000e+04, 1.180374e-01, 6.589266e-05, 9.430215e-09, 1.498379e-10,
       4.147375e-14, 2.114439e-16, 6.713607e-21, 9.760361e-24, 1.834315e-27,
       4.963472e-32, 0.000000e+00, 0.000000e+00},
      {1.125000e+04, 1.305079e-01, 1.577974e-04, 1.515320e-08, 2.731085e-10,
       9.740000e-14, 4.887584e-16, 1.995216e-20, 3.413471e-23, 7.979229e-27,
       2.813145e-31, 0.000000e+00, 0.000000e+00},
      {1.150000e+04, 1.423366e-01, 3.894983e-04, 2.370397e-08, 4.831230e-10,
       2.216310e-13, 1.053853e-15, 5.432221e-20, 1.079215e-22, 3.075807e-26,
       1.375472e-30, 8.872075e-35, 0.000000e+00},
      {1.175000e+04, 1.535072e-01, 8.543302e-04, 3.661202e-08, 8.435606e-10,
       4.950557e-13, 2.163979e-15, 1.377147e-19, 3.123614e-22, 1.063771e-25,
       5.904733e-30, 8.817311e-34, 0.000000e+00},
      {1.200000e+04, 1.641602e-01, 1.624145e-03, 5.593229e-08, 1.449426e-09,
       1.078767e-12, 4.246385e-15, 3.253018e-19, 8.301990e-22, 3.321901e-25,
       2.246233e-29, 4.427302e-33, 0.000000e+00},
      {1.225000e+04, 1.742604e-01, 2.731697e-03, 8.330768e-08, 2.422998e-09,
       2.285470e-12, 7.922822e-15, 7.160139e-19, 2.035680e-21, 9.427323e-25,
       7.608530e-29, 1.790373e-32, 0.000000e+00},
      {1.250000e+04, 1.839635e-01, 4.189391e-03, 1.239890e-07, 4.053759e-09,
       4.792459e-12, 1.447517e-14, 1.524003e-18, 4.768503e-21, 2.505779e-24,
       2.367115e-28, 6.494988e-32, 0.000000e+00},
      {1.275000e+04, 1.932574e-01, 5.981690e-03, 1.849000e-07, 6.760232e-09,
       9.892730e-12, 2.629173e-14, 3.176970e-18, 1.078677e-20, 6.318830e-24,
       6.880567e-28, 2.164021e-31, 0.000000e+00},
      {1.300000e+04, 2.022091e-01, 8.100342e-03, 2.724176e-07, 1.108628e-08,
       1.988145e-11, 4.717626e-14, 6.439445e-18, 2.350323e-20, 1.517604e-23,
       1.875096e-27, 6.639634e-31, 0.000000e+00},
      {1.400000e+04, 2.349437e-01, 1.936139e-02, 1.211481e-06, 7.264962e-08,
       2.561653e-10, 5.281773e-13, 1.160897e-16, 5.423667e-19, 4.562912e-22,
       7.656405e-26, 3.761068e-29, 2.571989e-34},
      {1.500000e+04, 2.630610e-01, 3.411998e-02, 4.608076e-06, 3.756686e-07,
       2.170476e-09, 5.981525e-12, 2.369529e-15, 1.541807e-17, 1.826391e-20,
       3.927580e-24, 2.119691e-27, 2.122086e-32},
      {1.600000e+04, 2.867101e-01, 5.077879e-02, 1.443370e-05, 1.510701e-06,
       1.258901e-08, 4.086674e-11, 2.923069e-14, 2.792789e-16, 5.449428e-19,
       2.048816e-22, 1.620229e-25, 2.230164e-30},
      {1.700000e+04, 3.060918e-01, 6.839525e-02, 3.724574e-05, 4.788728e-06,
       5.474012e-08, 1.835237e-10, 2.100415e-13, 2.754865e-15, 8.312139e-18,
       5.427729e-21, 6.598768e-24, 1.893374e-28},
      {1.800000e+04, 3.217211e-01, 8.622793e-02, 7.960182e-05, 1.233731e-05,
       1.887290e-07, 6.513338e-10, 1.083489e-12, 1.817424e-14, 7.637275e-17,
       7.572177e-20, 1.111246e-22, 6.001972e-27},
      {1.900000e+04, 3.341145e-01, 1.038561e-01, 1.474157e-04, 2.684964e-05,
       5.328618e-07, 1.890794e-09, 4.355125e-12, 9.054460e-14, 5.107470e-16,
       7.325396e-19, 1.044902e-21, 9.562346e-26},
      {2.000000e+04, 3.438727e-01, 1.210431e-01, 2.464805e-04, 5.224159e-05,
       1.320112e-06, 5.049390e-09, 1.591617e-11, 4.048120e-13, 3.011862e-15,
       6.048776e-18, 7.086695e-21, 9.726900e-25},
      {2.100000e+04, 3.516871e-01, 1.375938e-01, 3.865648e-04, 9.394586e-05,
       2.968735e-06, 1.234736e-08, 5.208193e-11, 1.586802e-12, 1.528536e-14,
       4.221743e-17, 3.701822e-20, 7.100133e-24},
      {2.200000e+04, 3.579895e-01, 1.533178e-01, 5.790629e-04, 1.603721e-04,
       6.274994e-06, 2.923084e-08, 1.652412e-10, 5.945004e-12, 7.390135e-14,
       2.783104e-16, 1.680412e-19, 4.372153e-23},
      {2.300000e+04, 3.632330e-01, 1.683000e-01, 8.465539e-04, 2.655316e-04,
       1.277240e-05, 6.939128e-08, 5.187456e-10, 2.121407e-11, 3.305718e-13,
       1.634283e-15, 6.960306e-19, 2.366259e-22},
      {2.400000e+04, 3.675153e-01, 1.821706e-01, 1.226039e-03, 4.357357e-04,
       2.576333e-05, 1.684018e-07, 1.655121e-09, 7.347247e-11, 1.413203e-12,
       9.009425e-15, 2.696291e-18, 1.195983e-21},
      {2.500000e+04, 3.709106e-01, 1.947883e-01, 1.780636e-03, 7.197008e-04,
       5.214699e-05, 4.317062e-07, 5.456690e-09, 2.464978e-10, 5.669563e-12,
       4.490705e-14, 1.053982e-17, 6.135622e-21},
      {2.600000e+04, 3.734070e-01, 2.060050e-01, 2.594443e-03, 1.194594e-03,
       1.052101e-04, 1.129566e-06, 1.795338e-08, 7.704201e-10, 2.080713e-11,
       1.992185e-13, 4.211267e-17, 3.163109e-20},
      {2.700000e+04, 3.749657e-01, 2.157038e-01, 3.757661e-03, 1.967893e-03,
       2.079074e-04, 2.980871e-06, 5.764587e-08, 2.284114e-09, 7.128080e-11,
       8.091092e-13, 1.620417e-16, 1.585085e-19},
      {2.800000e+04, 3.753440e-01, 2.238699e-01, 5.370611e-03, 3.188336e-03,
       4.027629e-04, 7.637324e-06, 1.762344e-07, 6.596640e-09, 2.359030e-10,
       3.142000e-12, 6.443179e-16, 8.440172e-19},
      {2.900000e+04, 3.742495e-01, 2.304200e-01, 7.622913e-03, 5.133786e-03,
       7.813685e-04, 1.925960e-05, 5.305257e-07, 2.122972e-08, 8.648839e-10,
       1.338065e-11, 2.673620e-15, 4.644036e-18},
      {3.000000e+04, 3.713424e-01, 2.352044e-01, 1.084561e-02, 8.319902e-03,
       1.527945e-03, 4.801628e-05, 1.638545e-06, 8.091003e-08, 3.613906e-09,
       6.273959e-11, 1.115547e-14, 2.612443e-17},
      {3.100000e+04, 3.661386e-01, 2.379136e-01, 1.548690e-02, 1.352550e-02,
       2.927910e-03, 1.198204e-04, 5.283369e-06, 3.500729e-07, 1.590667e-08,
       2.997544e-10, 4.659461e-14, 1.516049e-16},
      {3.200000e+04, 3.583166e-01, 2.383179e-01, 2.185713e-02, 2.148928e-02,
       5.259423e-03, 2.909920e-04, 1.683432e-05, 1.474287e-06, 6.557205e-08,
       1.343997e-09, 1.834694e-13, 8.295517e-16},
      {3.300000e+04, 3.480040e-01, 2.362164e-01, 2.989753e-02, 3.246263e-02,
       8.616601e-03, 6.689834e-04, 5.059997e-05, 5.425473e-06, 2.417180e-07,
       5.433593e-09, 6.423763e-13, 3.871209e-15},
      {3.400000e+04, 3.361738e-01, 2.324139e-01, 3.899143e-02, 4.566584e-02,
       1.275838e-02, 1.434153e-03, 1.421757e-04, 1.693686e-05, 7.456559e-07,
       1.824617e-08, 1.921835e-12, 1.474044e-14},
      {3.500000e+04, 3.233471e-01, 2.271292e-01, 4.857882e-02, 6.015342e-02,
       1.741049e-02, 2.990973e-03, 3.915977e-04, 4.705300e-05, 1.958759e-06,
       5.212892e-08, 5.190843e-12, 4.820434e-14},
      {3.600000e+04, 3.100697e-01, 2.207284e-01, 5.782988e-02, 7.466257e-02,
       2.227547e-02, 6.162707e-03, 9.948310e-04, 1.170736e-04, 4.712003e-06,
       1.373543e-07, 1.303082e-11, 1.390160e-13},
      {3.700000e+04, 2.967351e-01, 2.134993e-01, 6.583121e-02, 8.808684e-02,
       2.713502e-02, 1.189268e-02, 2.112064e-03, 2.506968e-04, 1.079810e-05,
       3.386804e-07, 3.044696e-11, 3.644106e-13},
      {3.800000e+04, 2.836270e-01, 2.057812e-01, 7.210509e-02, 9.982315e-02,
       3.186588e-02, 2.046797e-02, 3.719283e-03, 4.572879e-04, 2.396603e-05,
       7.676598e-07, 6.701843e-11, 8.962347e-13},
      {3.900000e+04, 2.708792e-01, 1.978364e-01, 7.676125e-02, 1.099285e-01,
       3.645517e-02, 3.126734e-02, 5.631455e-03, 7.319517e-04, 5.629582e-05,
       1.575250e-06, 1.382036e-10, 2.063183e-12},
      {4.000000e+04, 2.585942e-01, 1.898527e-01, 8.022837e-02, 1.187604e-01,
       4.093087e-02, 4.320394e-02, 7.653528e-03, 1.068410e-03, 1.521625e-04,
       2.964106e-06, 2.653361e-10, 4.468873e-12},
      {4.100000e+04, 2.468327e-01, 1.819691e-01, 8.292124e-02, 1.266790e-01,
       4.533527e-02, 5.525636e-02, 9.652751e-03, 1.465745e-03, 4.189528e-04,
       5.315868e-06, 4.907407e-10, 9.561195e-12},
      {4.200000e+04, 2.356018e-01, 1.742881e-01, 8.512051e-02, 1.339574e-01,
       4.969032e-02, 6.667101e-02, 1.154629e-02, 1.924367e-03, 1.028595e-03,
       9.769702e-06, 9.237160e-10, 2.129768e-11},
      {4.300000e+04, 2.249233e-01, 1.668682e-01, 8.693221e-02, 1.406838e-01,
       5.399274e-02, 7.706307e-02, 1.331858e-02, 2.447659e-03, 2.167130e-03,
       2.009114e-05, 1.834702e-09, 5.075074e-11},
      {4.400000e+04, 2.147393e-01, 1.597484e-01, 8.845286e-02, 1.468450e-01,
       5.818903e-02, 8.632861e-02, 1.497649e-02, 3.041773e-03, 3.973482e-03,
       4.604561e-05, 3.908514e-09, 1.305226e-10},
      {4.500000e+04, 2.050111e-01, 1.529011e-01, 8.966990e-02, 1.524399e-01,
       6.224274e-02, 9.455588e-02, 1.657247e-02, 3.712941e-03, 6.460184e-03,
       1.054762e-04, 8.920415e-09, 3.555624e-10},
      {4.600000e+04, 1.957177e-01, 1.463509e-01, 9.058364e-02, 1.574376e-01,
       6.612194e-02, 1.018979e-01, 1.811302e-02, 4.460318e-03, 9.539840e-03,
       2.221415e-04, 2.109918e-08, 9.673535e-10},
      {4.700000e+04, 1.868699e-01, 1.400899e-01, 9.122714e-02, 1.618303e-01,
       6.978098e-02, 1.085085e-01, 1.964645e-02, 5.293287e-03, 1.304722e-02,
       4.189684e-04, 4.898676e-08, 2.469066e-09},
      {4.800000e+04, 1.784337e-01, 1.341223e-01, 9.162453e-02, 1.656696e-01,
       7.320753e-02, 1.145195e-01, 2.117477e-02, 6.213852e-03, 1.681295e-02,
       7.123481e-04, 1.069046e-07, 5.733245e-09},
      {4.900000e+04, 1.704123e-01, 1.284579e-01, 9.179958e-02, 1.690046e-01,
       7.643031e-02, 1.200407e-01, 2.271264e-02, 7.217624e-03, 2.064876e-02,
       1.105725e-03, 2.151757e-07, 1.214172e-08},
  };

  // ###########################################################################
  powr_mw_wc.info = "#COMMENT: SED - PoWR Model Atmospheres\n"
                    "#COMMENT: SED parameters:\n"
                    "#COMMENT: Metallicity = MW\n"
                    "#COMMENT: Composition = WC\n"
                    "#COMMENT: Mdot = -5.0\n";

  powr_mw_wc.data = {
      {3.981000e+04, 2.355263e-01, 1.608154e-01, 1.648405e-01, 1.419853e-01,
       9.551552e-03, 7.850990e-03, 4.481900e-04, 5.409203e-05, 3.391179e-06,
       2.585601e-11, 1.035232e-16, 3.088562e-18},
      {4.466800e+04, 2.166053e-01, 1.423459e-01, 1.672898e-01, 1.930928e-01,
       2.225192e-02, 1.573238e-02, 5.823392e-04, 1.448024e-04, 1.108820e-05,
       2.432742e-11, 2.109766e-14, 1.012455e-16},
      {5.011900e+04, 1.990179e-01, 1.324792e-01, 1.664395e-01, 2.247348e-01,
       4.421890e-02, 2.837398e-02, 7.633621e-04, 2.992617e-04, 2.575050e-05,
       8.884223e-11, 5.766241e-14, 1.248448e-15},
      {5.623400e+04, 1.706344e-01, 1.183240e-01, 1.464002e-01, 2.423777e-01,
       9.069992e-02, 6.444339e-02, 1.561568e-03, 1.475314e-03, 7.933296e-05,
       2.553843e-12, 3.159718e-13, 1.965371e-14},
      {6.309600e+04, 1.566360e-01, 1.026206e-01, 1.362234e-01, 2.219507e-01,
       1.163405e-01, 1.112092e-01, 6.839990e-03, 8.995903e-03, 1.820588e-04,
       5.589841e-11, 3.623696e-13, 5.218980e-14},
      {7.079500e+04, 1.444797e-01, 9.492018e-02, 1.157632e-01, 1.930350e-01,
       1.150329e-01, 1.564119e-01, 2.635599e-02, 2.754755e-02, 1.260687e-03,
       6.217428e-09, 2.934894e-11, 1.701221e-12},
      {7.943300e+04, 1.283364e-01, 8.330299e-02, 1.003263e-01, 1.719913e-01,
       1.010927e-01, 1.818799e-01, 6.238683e-02, 5.417704e-02, 5.478334e-03,
       7.579129e-07, 2.253814e-10, 1.182141e-11},
      {8.912500e+04, 1.158556e-01, 7.522137e-02, 9.089152e-02, 1.606837e-01,
       9.551927e-02, 1.900532e-01, 8.481502e-02, 7.401196e-02, 9.542854e-03,
       4.707603e-04, 3.946620e-10, 5.938894e-11},
      {1.000000e+05, 1.070630e-01, 7.288419e-02, 8.765157e-02, 1.574682e-01,
       9.469550e-02, 1.969723e-01, 9.107931e-02, 8.017908e-02, 1.220449e-02,
       1.232378e-03, 8.645277e-10, 1.089568e-10},
      {1.122020e+05, 1.032878e-01, 6.986787e-02, 8.627367e-02, 1.571880e-01,
       9.355837e-02, 2.005736e-01, 9.686782e-02, 8.293762e-02, 1.487400e-02,
       3.094915e-03, 3.922211e-10, 2.326187e-11},
      {1.258920e+05, 9.973399e-02, 6.743440e-02, 7.948776e-02, 1.503431e-01,
       9.155656e-02, 2.017416e-01, 1.064466e-01, 8.874655e-02, 1.896792e-02,
       5.915258e-03, 3.392039e-10, 1.823607e-11},
      {1.412540e+05, 9.615302e-02, 6.539379e-02, 7.575378e-02, 1.447587e-01,
       8.801759e-02, 2.030264e-01, 1.129641e-01, 9.470421e-02, 2.329852e-02,
       8.521439e-03, 2.158501e-10, 8.136951e-12},
      {1.584890e+05, 9.250999e-02, 6.441234e-02, 7.572292e-02, 1.385209e-01,
       8.432154e-02, 2.037375e-01, 1.172750e-01, 9.927630e-02, 2.789178e-02,
       1.026964e-02, 2.065053e-10, 1.813235e-12},
      {1.778280e+05, 9.650846e-02, 6.471186e-02, 7.499873e-02, 1.358055e-01,
       8.031088e-02, 1.979799e-01, 1.191151e-01, 1.018566e-01, 3.204176e-02,
       1.297411e-02, 2.273344e-10, 3.477148e-12},
      {1.995260e+05, 1.165396e-01, 8.294175e-02, 9.056321e-02, 1.527536e-01,
       8.738929e-02, 1.893407e-01, 8.316400e-02, 7.723900e-02, 1.363211e-02,
       3.909717e-05, 2.440016e-09, 1.274872e-10},
  };

  // ###########################################################################

  powr_mw_wne.info = "#COMMENT: SED - PoWR Model Atmospheres\n"
                     "#COMMENT: SED parameters:\n"
                     "#COMMENT: Metallicity = MW\n"
                     "#COMMENT: Composition = WNE\n"
                     "#COMMENT: Mdot = -5.0\n";

  powr_mw_wne.data = {
      {3.162300e+04, 2.525916e-01, 2.031145e-01, 1.241354e-01, 5.826659e-02,
       1.078467e-03, 7.776509e-04, 7.734731e-05, 4.030966e-06, 4.733242e-08,
       8.535614e-13, 2.277898e-16, 4.622607e-98},
      {3.548100e+04, 2.466044e-01, 1.829740e-01, 1.360527e-01, 1.182760e-01,
       5.721356e-03, 4.997405e-03, 2.663367e-04, 4.021262e-05, 1.225686e-06,
       3.705015e-10, 1.014047e-14, 1.383210e-17},
      {3.981100e+04, 2.057306e-01, 1.492018e-01, 1.355348e-01, 1.987535e-01,
       3.877800e-02, 3.019575e-02, 6.095640e-04, 3.868590e-04, 4.574774e-05,
       7.775775e-09, 1.097478e-13, 4.650234e-98},
      {4.466800e+04, 1.682268e-01, 1.247408e-01, 1.234082e-01, 2.282029e-01,
       9.213572e-02, 7.165150e-02, 1.106182e-03, 1.931708e-03, 2.700977e-04,
       1.328640e-08, 1.477136e-13, 1.151488e-18},
      {5.011900e+04, 1.417825e-01, 1.104620e-01, 1.120463e-01, 2.165444e-01,
       1.171870e-01, 1.378130e-01, 5.398420e-03, 7.819933e-03, 8.903380e-04,
       5.746090e-05, 7.485959e-14, 9.446002e-15},
      {5.623400e+04, 1.192687e-01, 9.448859e-02, 9.856371e-02, 1.987387e-01,
       1.139313e-01, 1.963040e-01, 3.021572e-02, 2.399424e-02, 1.977289e-03,
       6.290654e-04, 3.084660e-12, 4.724997e-13},
      {6.309600e+04, 1.003090e-01, 7.933040e-02, 8.606710e-02, 1.768602e-01,
       1.038398e-01, 2.198173e-01, 7.684674e-02, 4.857000e-02, 4.492434e-03,
       2.024400e-03, 4.998584e-12, 1.551084e-12},
      {7.079500e+04, 8.898976e-02, 6.668837e-02, 7.539559e-02, 1.572540e-01,
       9.551896e-02, 2.049180e-01, 1.092443e-01, 9.332182e-02, 1.513654e-02,
       5.111547e-03, 6.024827e-12, 5.159384e-12},
      {7.943300e+04, 7.949728e-02, 5.615309e-02, 6.573961e-02, 1.390402e-01,
       8.780787e-02, 1.862790e-01, 1.175643e-01, 1.463003e-01, 3.456886e-02,
       9.230116e-03, 1.065080e-11, 1.582081e-11},
      {8.912500e+04, 7.319311e-02, 5.016304e-02, 6.110889e-02, 1.315684e-01,
       8.570333e-02, 1.838792e-01, 1.164693e-01, 1.649695e-01, 4.916972e-02,
       1.256435e-02, 1.284173e-11, 1.602201e-11},
      {1.000000e+05, 7.008400e-02, 4.711622e-02, 5.929720e-02, 1.314199e-01,
       8.779920e-02, 1.867595e-01, 1.140371e-01, 1.653391e-01, 5.565527e-02,
       1.602209e-02, 8.018307e-12, 6.681273e-12},
      {1.122020e+05, 6.544545e-02, 4.503570e-02, 5.575255e-02, 1.259507e-01,
       8.529000e-02, 1.830358e-01, 1.156897e-01, 1.750312e-01, 6.416093e-02,
       2.033770e-02, 3.809715e-13, 2.884817e-12},
      {1.258920e+05, 6.172388e-02, 4.281856e-02, 5.205158e-02, 1.161378e-01,
       7.965428e-02, 1.779078e-01, 1.171814e-01, 1.876709e-01, 7.633891e-02,
       2.632282e-02, 2.319446e-11, 1.956333e-11},
      {1.412540e+05, 5.832673e-02, 3.998482e-02, 4.725505e-02, 1.059227e-01,
       7.479165e-02, 1.752939e-01, 1.195907e-01, 1.986308e-01, 8.806594e-02,
       3.156194e-02, 4.257595e-11, 7.129099e-11},
      {1.584890e+05, 5.349620e-02, 3.816621e-02, 4.380935e-02, 9.790540e-02,
       7.059083e-02, 1.718891e-01, 1.193419e-01, 2.103156e-01, 9.723933e-02,
       3.753570e-02, 5.455531e-11, 1.256981e-10},
      {1.778280e+05, 5.061889e-02, 3.594386e-02, 4.052773e-02, 9.129236e-02,
       6.743654e-02, 1.695749e-01, 1.193970e-01, 2.149812e-01, 1.094884e-01,
       4.228338e-02, 8.546668e-11, 2.499867e-10},
      {1.995260e+05, 7.265299e-03, 8.326230e-03, 1.186835e-02, 3.348831e-02,
       2.670587e-02, 7.929765e-02, 6.442551e-02, 8.773520e-02, 1.127914e-01,
       8.452418e-02, 8.453374e-02, 6.796729e-02},
  };

  // ###########################################################################

  blackbody.info = "#COMMENT: SED - Blackbody\n";
  blackbody.data = {
      {3.500000e+03, 2.816461e-08, 6.379917e-13, 3.767048e-16, 1.754737e-17,
       8.691884e-20, 5.289807e-27, 3.278253e-31, 1.222742e-39, 7.155071e-46,
       4.131797e-54, 6.912678e-64, 4.273108e-73, 2.033039e-87},
      {3.750000e+03, 1.250300e-07, 6.200968e-12, 6.147673e-15, 3.604453e-16,
       2.604394e-18, 5.064201e-25, 6.143293e-29, 8.722413e-37, 1.364517e-42,
       2.876884e-50, 2.226277e-59, 5.801461e-68, 2.572846e-81},
      {4.000000e+03, 4.554606e-07, 4.481632e-11, 6.975690e-14, 5.010026e-15,
       5.040964e-17, 2.708083e-23, 5.912589e-27, 2.703702e-34, 9.999233e-40,
       6.546537e-47, 1.934913e-55, 1.775678e-63, 5.552910e-76},
      {4.250000e+03, 1.410853e-06, 2.539461e-10, 5.871901e-13, 5.051465e-14,
       6.813130e-16, 8.970928e-22, 3.289724e-25, 4.221819e-32, 3.335795e-37,
       5.935232e-44, 5.722675e-52, 1.594831e-59, 2.794756e-71},
      {4.500000e+03, 3.820334e-06, 1.175502e-09, 3.856132e-12, 3.899697e-13,
       6.830745e-15, 1.995061e-20, 1.160056e-23, 3.725248e-30, 5.779666e-35,
       2.500793e-41, 6.897352e-49, 5.159430e-56, 4.183414e-67},
      {4.750000e+03, 9.241604e-06, 4.591381e-09, 2.055643e-11, 2.405342e-12,
       5.328233e-14, 3.173633e-19, 2.787623e-22, 2.033709e-28, 5.770680e-33,
       5.529699e-39, 3.905639e-46, 7.067572e-53, 2.256623e-63},
      {5.000000e+03, 2.032105e-05, 1.552841e-08, 9.182100e-11, 1.226405e-11,
       3.359181e-13, 3.798787e-18, 4.837264e-21, 7.385304e-27, 3.608026e-31,
       7.071346e-37, 1.164206e-43, 4.665454e-50, 5.114559e-60},
      {5.250000e+03, 4.118795e-05, 4.643483e-08, 3.525912e-10, 5.313134e-11,
       1.765189e-12, 3.564648e-17, 6.352407e-20, 1.891686e-25, 1.510895e-29,
       5.657412e-35, 2.002946e-41, 1.647890e-47, 5.514914e-57},
      {5.500000e+03, 7.783430e-05, 1.248821e-07, 1.188600e-09, 2.000290e-10,
       7.928338e-12, 2.711540e-16, 6.559858e-19, 3.585440e-24, 4.477132e-28,
       3.019709e-33, 2.144379e-39, 3.392731e-45, 3.131737e-54},
      {5.750000e+03, 1.384285e-04, 3.063393e-07, 3.578838e-09, 6.666802e-10,
       3.107561e-11, 1.718876e-15, 5.498013e-18, 5.231525e-23, 9.823813e-27,
       1.133947e-31, 1.520267e-37, 4.369742e-43, 1.018579e-51},
      {6.000000e+03, 2.335175e-04, 6.934756e-07, 9.764203e-09, 1.997707e-09,
       1.081444e-10, 9.291668e-15, 3.839813e-17, 6.073123e-22, 1.657649e-25,
       3.131112e-30, 7.516367e-36, 3.734386e-41, 2.034833e-49},
      {6.250000e+03, 3.760864e-04, 1.463003e-06, 2.443204e-08, 5.452094e-09,
       3.390208e-10, 4.366634e-14, 2.284579e-16, 5.766355e-21, 2.220340e-24,
       6.597801e-29, 2.706724e-34, 2.224904e-39, 2.647789e-47},
      {6.500000e+03, 5.814608e-04, 2.900303e-06, 5.664192e-08, 1.370152e-08,
       9.691762e-10, 1.813387e-13, 1.179802e-15, 4.584044e-20, 2.425020e-23,
       1.094775e-27, 7.365365e-33, 9.635916e-38, 2.358436e-45},
      {6.750000e+03, 8.670572e-04, 5.441087e-06, 1.227260e-07, 3.200334e-08,
       2.553024e-09, 6.747699e-13, 5.373099e-15, 3.112406e-19, 2.209537e-22,
       1.469199e-26, 1.562620e-31, 3.143612e-36, 1.500085e-43},
      {7.000000e+03, 1.251998e-03, 9.718319e-06, 2.503677e-07, 7.003393e-08,
       6.252486e-09, 2.276702e-12, 2.187598e-14, 1.835885e-18, 1.712680e-21,
       1.631576e-25, 2.655023e-30, 7.964686e-35, 7.064714e-42},
      {7.250000e+03, 1.756624e-03, 1.661171e-05, 4.839897e-07, 1.445747e-07,
       1.434590e-08, 7.037037e-12, 8.056214e-14, 9.547126e-18, 1.148581e-20,
       1.529224e-24, 3.697220e-29, 1.608904e-33, 2.541681e-40},
      {7.500000e+03, 2.401933e-03, 2.729643e-05, 8.914769e-07, 2.832239e-07,
       3.104294e-08, 2.010283e-11, 2.710974e-13, 4.433013e-17, 6.762374e-20,
       1.230528e-23, 4.304950e-28, 2.650968e-32, 7.177014e-39},
      {7.750000e+03, 3.208989e-03, 4.328752e-05, 1.572124e-06, 5.292597e-07,
       6.371843e-08, 5.348842e-11, 8.409855e-13, 1.858361e-16, 3.540038e-19,
       8.628326e-23, 4.264962e-27, 3.634155e-31, 1.628517e-37},
      {8.000000e+03, 4.198329e-03, 6.647637e-05, 2.665563e-06, 9.477047e-07,
       1.246881e-07, 1.334525e-10, 2.423678e-12, 7.101787e-16, 1.666151e-18,
       5.341028e-22, 3.650360e-26, 4.217540e-30, 3.031199e-36},
      {8.250000e+03, 5.389407e-03, 9.915639e-05, 4.361297e-06, 1.632550e-06,
       2.336493e-07, 3.140727e-10, 6.533263e-12, 2.495175e-15, 7.119622e-18,
       2.952209e-21, 2.735545e-25, 4.207151e-29, 4.712706e-35},
      {8.500000e+03, 6.800086e-03, 1.440354e-04, 6.908366e-06, 2.714994e-06,
       4.208981e-07, 7.008710e-10, 1.657106e-11, 8.120511e-15, 2.785948e-17,
       1.471866e-20, 1.816216e-24, 3.656166e-28, 6.218613e-34},
      {8.750000e+03, 8.446206e-03, 2.042335e-04, 1.062462e-05, 4.372441e-06,
       7.314085e-07, 1.489900e-09, 3.975874e-11, 2.464301e-14, 1.005937e-16,
       6.678215e-20, 1.079558e-23, 2.801169e-27, 7.063545e-33},
      {9.000000e+03, 1.034123e-02, 2.832658e-04, 1.590503e-05, 6.837937e-06,
       1.229824e-06, 3.029493e-09, 9.066031e-11, 7.014385e-14, 3.374338e-16,
       2.779486e-19, 5.798457e-23, 1.912137e-26, 6.993795e-32},
      {9.250000e+03, 1.249601e-02, 3.850100e-04, 2.322857e-05, 1.040963e-05,
       2.006361e-06, 5.913775e-09, 1.972977e-10, 1.882566e-13, 1.057903e-15,
       1.068678e-18, 2.837674e-22, 1.173973e-25, 6.104184e-31},
      {9.500000e+03, 1.491857e-02, 5.136617e-04, 3.316317e-05, 1.545980e-05,
       3.183582e-06, 1.111890e-08, 4.113121e-10, 4.786446e-13, 3.116619e-15,
       3.819883e-18, 1.274710e-21, 6.537574e-25, 4.743698e-30},
      {9.750000e+03, 1.761404e-02, 6.736768e-04, 4.636838e-05, 2.244310e-05,
       4.923928e-06, 2.019457e-08, 8.241813e-10, 1.157727e-12, 8.669676e-15,
       1.276538e-17, 5.291070e-21, 3.327199e-24, 3.311950e-29},
      {1.000000e+04, 2.058468e-02, 8.697054e-04, 6.359563e-05, 3.190338e-05,
       7.437853e-06, 3.552454e-08, 1.592155e-09, 2.674073e-12, 2.287137e-14,
       4.008762e-17, 2.041518e-20, 1.558111e-23, 2.094301e-28},
      {1.025000e+04, 2.382988e-02, 1.106519e-03, 8.568577e-05, 4.447902e-05,
       1.099236e-05, 6.067029e-08, 2.973310e-09, 5.918293e-12, 5.744539e-14,
       1.188435e-16, 7.361746e-20, 6.755235e-23, 1.208232e-27},
      {1.050000e+04, 2.734630e-02, 1.388933e-03, 1.135642e-04, 6.090619e-05,
       1.591972e-05, 1.008118e-07, 5.380897e-09, 1.258972e-11, 1.378580e-13,
       3.339897e-16, 2.493117e-19, 2.726560e-22, 6.401515e-27},
      {1.075000e+04, 3.112804e-02, 1.721731e-03, 1.482332e-04, 8.201994e-05,
       2.262606e-05, 1.632977e-07, 9.457923e-09, 2.581349e-11, 3.171165e-13,
       8.931393e-16, 7.964479e-19, 1.029692e-21, 3.133528e-26},
      {1.100000e+04, 3.516685e-02, 2.109584e-03, 1.907628e-04, 1.087531e-04,
       3.159960e-05, 2.583160e-07, 1.617864e-08, 5.114371e-11, 7.012677e-13,
       2.280446e-15, 2.409728e-18, 3.655126e-21, 1.424831e-25},
      {1.125000e+04, 3.945232e-02, 2.556979e-03, 2.422788e-04, 1.421326e-04,
       4.341821e-05, 3.996916e-07, 2.698316e-08, 9.814258e-11, 1.494796e-12,
       5.576836e-15, 6.930467e-18, 1.224641e-20, 6.048149e-25},
      {1.150000e+04, 4.397218e-02, 3.068151e-03, 3.039497e-04, 1.832740e-04,
       5.875612e-05, 6.058142e-07, 4.395187e-08, 1.827929e-10, 3.078695e-12,
       1.309961e-14, 1.901031e-17, 3.887558e-20, 2.407537e-24},
      {1.175000e+04, 4.871250e-02, 3.647021e-03, 3.769729e-04, 2.333733e-04,
       7.838938e-05, 9.006968e-07, 7.002651e-08, 3.310826e-10, 6.140472e-12,
       2.963196e-14, 4.988539e-17, 1.173319e-19, 9.024221e-24},
      {1.200000e+04, 5.365798e-02, 4.297140e-03, 4.625595e-04, 2.936973e-04,
       1.032001e-04, 1.315156e-06, 1.092845e-07, 5.841931e-10, 1.188419e-11,
       6.470357e-14, 1.255824e-16, 3.377606e-19, 3.197256e-23},
      {1.225000e+04, 5.879222e-02, 5.021645e-03, 5.619188e-04, 3.655718e-04,
       1.341789e-04, 1.888103e-06, 1.672729e-07, 1.005830e-09, 2.236042e-11,
       1.366820e-13, 3.040671e-16, 9.300909e-19, 1.074449e-22},
      {1.250000e+04, 6.409792e-02, 5.823223e-03, 6.762435e-04, 4.503693e-04,
       1.724263e-04, 2.667937e-06, 2.514078e-07, 1.692345e-09, 4.097114e-11,
       2.798869e-13, 7.097743e-16, 2.456590e-18, 3.435765e-22},
      {1.275000e+04, 6.955716e-02, 6.704082e-03, 8.066948e-04, 5.494949e-04,
       2.191517e-04, 3.714000e-06, 3.714426e-07, 2.786421e-09, 7.322334e-11,
       5.566037e-13, 1.600755e-15, 6.238872e-18, 1.048503e-21},
      {1.300000e+04, 7.515161e-02, 7.665931e-03, 9.543882e-04, 6.643713e-04,
       2.756709e-04, 5.098097e-06, 5.400102e-07, 4.495194e-09, 1.278284e-10,
       1.076821e-12, 3.495058e-15, 1.526997e-17, 3.062000e-21},
      {1.400000e+04, 9.851102e-02, 1.233964e-02, 1.737595e-03, 1.309642e-03,
       6.294587e-04, 1.597230e-05, 2.089557e-06, 2.538778e-08, 9.630820e-10,
       1.179892e-11, 5.949037e-14, 3.941887e-16, 1.504118e-19},
      {1.500000e+04, 1.225811e-01, 1.831577e-02, 2.866258e-03, 2.315484e-03,
       1.268793e-03, 4.224812e-05, 6.654777e-06, 1.120587e-07, 5.462534e-09,
       9.262716e-11, 6.839439e-13, 6.506387e-15, 4.335826e-18},
      {1.600000e+04, 1.463309e-01, 2.547757e-02, 4.368789e-03, 3.751477e-03,
       2.312618e-03, 9.747557e-05, 1.810510e-05, 4.051464e-07, 2.461812e-08,
       5.550201e-10, 5.720774e-12, 7.473619e-14, 8.112613e-17},
      {1.700000e+04, 1.689279e-01, 3.362277e-02, 6.245350e-03, 5.661292e-03,
       3.882045e-03, 2.011089e-04, 4.328895e-05, 1.243634e-06, 9.186036e-08,
       2.663921e-09, 3.684615e-11, 6.373216e-13, 1.064104e-15},
      {1.800000e+04, 1.897596e-01, 4.249787e-02, 8.470165e-03, 8.058428e-03,
       6.087301e-03, 3.782540e-04, 9.298586e-05, 3.332501e-06, 2.930183e-07,
       1.063293e-08, 1.909711e-10, 4.242539e-12, 1.038747e-14},
      {1.900000e+04, 2.084229e-01, 5.183009e-02, 1.099691e-02, 1.092679e-02,
       9.016651e-03, 6.584703e-04, 1.825759e-04, 7.968288e-06, 8.193928e-07,
       3.635208e-08, 8.246417e-10, 2.293589e-11, 7.910582e-14},
      {2.000000e+04, 2.246945e-01, 6.135288e-02, 1.376541e-02, 1.422479e-02,
       1.272881e-02, 1.073832e-03, 3.322457e-04, 1.730119e-05, 2.049527e-06,
       1.089915e-07, 3.050239e-09, 1.039324e-10, 4.880148e-13},
      {2.100000e+04, 2.384952e-01, 7.082364e-02, 1.670824e-02, 1.789143e-02,
       1.724928e-02, 1.656592e-03, 5.666457e-04, 3.459730e-05, 4.660541e-06,
       2.920923e-07, 9.883566e-09, 4.049693e-10, 2.514211e-12},
      {2.200000e+04, 2.498547e-01, 8.003421e-02, 1.975647e-02, 2.185294e-02,
       2.257033e-02, 2.436808e-03, 9.140209e-04, 6.445769e-05, 9.763461e-06,
       7.106775e-07, 2.857344e-08, 1.385443e-09, 1.108955e-11},
      {2.300000e+04, 2.588802e-01, 8.881553e-02, 2.284406e-02, 2.602920e-02,
       2.865375e-02, 3.440254e-03, 1.404924e-03, 1.129547e-04, 1.905060e-05,
       1.590107e-06, 7.482484e-08, 4.233720e-09, 4.274419e-11},
      {2.400000e+04, 2.657290e-01, 9.703802e-02, 2.591094e-02, 3.033908e-02,
       3.543562e-02, 4.686802e-03, 2.070676e-03, 1.876569e-04, 3.493849e-05,
       3.306897e-06, 1.797326e-07, 1.172302e-08, 1.464550e-10},
      {2.500000e+04, 2.705890e-01, 1.046090e-01, 2.890489e-02, 3.470471e-02,
       4.283198e-02, 6.189397e-03, 2.941741e-03, 2.975317e-04, 6.068835e-05,
       6.449809e-06, 4.002110e-07, 2.976841e-08, 4.524944e-10},
      {2.600000e+04, 2.736615e-01, 1.114689e-01, 3.178241e-02, 3.905452e-02,
       5.074487e-02, 7.953604e-03, 4.046194e-03, 4.527300e-04, 1.004875e-04,
       1.188755e-05, 8.334992e-07, 7.002867e-08, 1.276020e-09},
      {2.700000e+04, 2.751511e-01, 1.175857e-01, 3.450882e-02, 4.332514e-02,
       5.906800e-02, 9.977681e-03, 5.408384e-03, 6.642725e-04, 1.594792e-04,
       2.083785e-05, 1.635951e-06, 1.539389e-07, 3.318228e-09},
      {2.800000e+04, 2.752566e-01, 1.229506e-01, 3.705786e-02, 4.746246e-02,
       6.769193e-02, 1.225308e-02, 7.047895e-03, 9.436663e-04, 2.437355e-04,
       3.493186e-05, 3.045821e-06, 3.185527e-07, 8.027596e-09},
      {2.900000e+04, 2.741666e-01, 1.275731e-01, 3.941099e-02, 5.142186e-02,
       7.650827e-02, 1.476522e-02, 8.978827e-03, 1.302485e-03, 3.601703e-04,
       5.626762e-05, 5.409230e-06, 6.245059e-07, 1.820492e-08},
      {3.000000e+04, 2.720559e-01, 1.314763e-01, 4.155644e-02, 5.516803e-02,
       8.541313e-02, 1.749451e-02, 1.120941e-02, 1.751943e-03, 5.164011e-04,
       8.744715e-05, 9.207989e-06, 1.166286e-06, 3.895536e-08},
      {3.100000e+04, 2.690839e-01, 1.346936e-01, 4.348822e-02, 5.867436e-02,
       9.430963e-02, 2.041741e-02, 1.374194e-02, 2.302496e-03, 7.205660e-04,
       1.315930e-04, 1.508759e-05, 2.084809e-06, 7.910441e-08},
      {3.200000e+04, 2.653943e-01, 1.372653e-01, 4.520518e-02, 6.192207e-02,
       1.031097e-01, 2.350749e-02, 1.657294e-02, 2.963486e-03, 9.811106e-04,
       1.923420e-04, 2.388348e-05, 3.582101e-06, 1.531992e-07},
      {3.300000e+04, 2.611153e-01, 1.392361e-01, 4.671004e-02, 6.489938e-02,
       1.117350e-01, 2.673652e-02, 1.969356e-02, 3.742849e-03, 1.306557e-03,
       2.738149e-04, 3.664369e-05, 5.937655e-06, 2.842086e-07},
      {3.400000e+04, 2.563597e-01, 1.406530e-01, 4.800860e-02, 6.760043e-02,
       1.201176e-01, 3.007537e-02, 2.309016e-02, 4.646897e-03, 1.705270e-03,
       3.805647e-04, 5.464608e-05, 9.525849e-06, 5.070133e-07},
      {3.500000e+04, 2.512266e-01, 1.415640e-01, 4.910896e-02, 7.002440e-02,
       1.281999e-01, 3.349481e-02, 2.674494e-02, 5.680169e-03, 2.185230e-03,
       5.175036e-04, 7.940882e-05, 1.483364e-05, 8.727435e-07},
      {3.600000e+04, 2.458021e-01, 1.420162e-01, 5.002089e-02, 7.217457e-02,
       1.359345e-01, 3.696628e-02, 3.063666e-02, 6.845358e-03, 2.753825e-03,
       6.898151e-04, 1.126931e-04, 2.247769e-05, 1.453972e-06},
      {3.700000e+04, 2.401607e-01, 1.420558e-01, 5.075535e-02, 7.405754e-02,
       1.432834e-01, 4.046236e-02, 3.474134e-02, 8.143302e-03, 3.417668e-03,
       9.028537e-04, 1.564977e-04, 3.321996e-05, 2.350722e-06},
      {3.800000e+04, 2.343664e-01, 1.417265e-01, 5.132395e-02, 7.568247e-02,
       1.502176e-01, 4.395724e-02, 3.903306e-02, 9.573031e-03, 4.182451e-03,
       1.162038e-03, 2.130447e-04, 4.798100e-05, 3.697184e-06},
      {3.900000e+04, 2.284736e-01, 1.410700e-01, 5.173869e-02, 7.706044e-02,
       1.567160e-01, 4.742704e-02, 4.348454e-02, 1.113187e-02, 5.052824e-03,
       1.472740e-03, 2.847584e-04, 6.785012e-05, 5.668992e-06},
      {4.000000e+04, 2.225287e-01, 1.401251e-01, 5.201162e-02, 7.820394e-02,
       1.627649e-01, 5.085000e-02, 4.806782e-02, 1.281556e-02, 6.032317e-03,
       1.840180e-03, 3.742362e-04, 9.409174e-05, 8.490850e-06},
      {4.100000e+04, 2.165709e-01, 1.389278e-01, 5.215465e-02, 7.912637e-02,
       1.683567e-01, 5.420660e-02, 5.275479e-02, 1.461845e-02, 7.123293e-03,
       2.269320e-03, 4.842141e-04, 1.281476e-04, 1.244427e-05},
      {4.200000e+04, 2.106327e-01, 1.375113e-01, 5.217934e-02, 7.984167e-02,
       1.734895e-01, 5.747962e-02, 5.751769e-02, 1.653363e-02, 8.326934e-03,
       2.764777e-03, 6.175275e-04, 1.716347e-04, 1.787512e-05},
      {4.300000e+04, 2.047414e-01, 1.359060e-01, 5.209684e-02, 8.036402e-02,
       1.781661e-01, 6.065413e-02, 6.232948e-02, 1.855316e-02, 9.643257e-03,
       3.330733e-03, 7.770688e-04, 2.263383e-04, 2.520083e-05},
      {4.400000e+04, 1.989195e-01, 1.341395e-01, 5.191775e-02, 8.070757e-02,
       1.823932e-01, 6.371741e-02, 6.716421e-02, 2.066826e-02, 1.107115e-02,
       3.970872e-03, 9.657435e-04, 2.942010e-04, 3.491674e-05},
      {4.500000e+04, 1.931850e-01, 1.322368e-01, 5.165208e-02, 8.088625e-02,
       1.861806e-01, 6.665885e-02, 7.199728e-02, 2.286947e-02, 1.260844e-02,
       4.688322e-03, 1.186425e-03, 3.773075e-04, 4.760159e-05},
      {4.600000e+04, 1.875529e-01, 1.302205e-01, 5.130924e-02, 8.091363e-02,
       1.895411e-01, 6.946985e-02, 7.680560e-02, 2.514686e-02, 1.425196e-02,
       5.485613e-03, 1.441913e-03, 4.778658e-04, 6.392182e-05},
      {4.700000e+04, 1.820346e-01, 1.281110e-01, 5.089798e-02, 8.080277e-02,
       1.924892e-01, 7.214369e-02, 8.156779e-02, 2.749018e-02, 1.599764e-02,
       6.364647e-03, 1.734890e-03, 5.981852e-04, 8.463438e-05},
      {4.800000e+04, 1.766393e-01, 1.259262e-01, 5.042645e-02, 8.056618e-02,
       1.950414e-01, 7.467531e-02, 8.626423e-02, 2.988905e-02, 1.784061e-02,
       7.326691e-03, 2.067884e-03, 7.406521e-04, 1.105882e-04},
      {4.900000e+04, 1.713738e-01, 1.236825e-01, 4.990216e-02, 8.021574e-02,
       1.972151e-01, 7.706125e-02, 9.087713e-02, 3.233304e-02, 1.977531e-02,
       8.372366e-03, 2.443233e-03, 9.077038e-04, 1.427237e-04},
  };

  // ###########################################################################
}
